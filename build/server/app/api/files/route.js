(()=>{var e={};e.id=635,e.ids=[635],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5651:()=>{},5979:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9468:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>v,routeModule:()=>w,serverHooks:()=>h,workAsyncStorage:()=>j,workUnitAsyncStorage:()=>y});var r={};s.r(r),s.d(r,{DELETE:()=>x,GET:()=>f,POST:()=>g});var a=s(6639),o=s(9880),i=s(7991),n=s(1246);let p=require("fs");var l=s(3873),u=s.n(l);let c=u().join(process.cwd(),"uploads");async function d(){try{await p.promises.access(c)}catch{await p.promises.mkdir(c,{recursive:!0})}}async function m(e){let t=u().join(c,e),s=await p.promises.stat(t);return{name:e,size:s.size,modified:s.mtime,stats:s}}async function f(e){await d();let{searchParams:t}=new URL(e.url),s=t.get("fileName");if(s)try{let e=u().join(c,s);try{await p.promises.access(e)}catch{return n.NextResponse.json({message:"File not found"},{status:404})}let t=await p.promises.readFile(e),r="application/octet-stream",a=u().extname(s).toLowerCase(),o={".txt":"text/plain",".html":"text/html",".css":"text/css",".js":"text/javascript",".json":"application/json",".pdf":"application/pdf",".png":"image/png",".jpg":"image/jpeg",".jpeg":"image/jpeg",".gif":"image/gif",".svg":"image/svg+xml"};return o[a]&&(r=o[a]),new n.NextResponse(t,{headers:{"Content-Type":r,"Content-Disposition":`attachment; filename="${s}"`}})}catch{return console.error("Download error:"),n.NextResponse.json({message:"Error downloading file"},{status:500})}try{let e=await p.promises.readdir(c),t=(await Promise.all(e.map(async e=>{try{return await m(e)}catch{return console.error(`Error getting stats for ${e}:`),null}}))).filter(Boolean);return n.NextResponse.json({files:t})}catch{return console.error("Error listing files:"),n.NextResponse.json({message:"Error listing files"},{status:500})}}async function g(e){await d();try{let t=(await e.formData()).get("file");if(!t)return n.NextResponse.json({message:"No file provided"},{status:400});let s=Buffer.from(await t.arrayBuffer()),r=t.name.replace(/[^\w\s.-]/gi,""),a=u().join(c,r);await p.promises.writeFile(a,s);let o=await m(r);return n.NextResponse.json({message:"File uploaded successfully",file:o})}catch(e){return console.error("Upload error:",e),n.NextResponse.json({message:"Error uploading file"},{status:500})}}async function x(e){await d();let{searchParams:t}=new URL(e.url),s=t.get("fileName");if(!s)return n.NextResponse.json({message:"No filename provided"},{status:400});try{let e=u().join(c,s);try{await p.promises.access(e)}catch{return n.NextResponse.json({message:"File not found"},{status:404})}return await p.promises.unlink(e),n.NextResponse.json({message:"File deleted successfully"})}catch(e){return console.error("Delete error:",e),n.NextResponse.json({message:"Error deleting file"},{status:500})}}let w=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/files/route",pathname:"/api/files",filename:"route",bundlePath:"app/api/files/route"},resolvedPagePath:"/home/pantho/Desktop/cloudvault/app/api/files/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:j,workUnitAsyncStorage:y,serverHooks:h}=w;function v(){return(0,i.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:y})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[31,714],()=>s(9468));module.exports=r})();